import csv
import os

#loading data files 
cvspath = os.path.join("Resources", "budget_data.csv")
pathout = os.path.join("Resources", "budget_analysis.txt")

#assigning variables and assigning to start at 0
total_month = 0
total_revenue = 0
previous_revenue = 0
revenue_change = 0
revenue_change_list = []
month_of_change = []
greatestIncrease = ["", 0]
greatestDecrease = ["", 99999999999]

#read budget_data.csv file
with open(cvspath) as revenueData:
   reader = csv.DictReader(revenueData)

#create loop through the data to find
   for row in reader:

       #total variable assignment 
           total_month = total_month + 1
           total_revenue = total_revenue + int(row["Profit/Losses"])

#delta revenue 
           revenue_change = int(row["Profit/Losses"]) - previous_revenue
           previous_Revenue = int(row["Profit/Losses"])
           month_of_change = month_of_change + [row["Date"]]

           #largest increase assignment
           if (revenue_change > greatestIncrease[1]):
               greatestIncrease[1] = revenue_change
               greatestIncrease[0] = row["Date"]

           if (revenue_change < greatestDecrease[1]):
               greatestDecrease[0] = row["Date"]
               greatestDecrease[1] = revenue_change
        
# average revenue calculation after loop
revenue_avg = sum(revenue_change_list) / len(revenue_change_list)


#print output
output = (
    f"Total Months: {total_month}\n"
    f"Total Revenue: {total_revenue}\n"
    f"Average Revenue Change: ${revenue_avg}\n"
    f"Greatest increase in Revenue: {greatestIncrease[0]} ${greatestIncrease[1]}\n"
    f"Greatest decrease in Revenue: {greatestDecrease[0]} ${greatestDecrease[1]}\n"
)

print(output)

#write to text file
with open(pathout, "w") as txt_file:
    txt_file.write(output)


